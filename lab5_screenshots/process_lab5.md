# Lab №5

## 1 Часть

### 1.1 Подключение

Создадим заданную схему (одним патч-кордом соединим гигабитные порты коммутаторов)

**\*картинка схемы\***

### 1.2 Активация работы STP

Включим и поставим версию протокола STP

`enable stp`

`config stp version stp`

<img src="Снимок экрана от 2021-11-24 09-21-38.png" />
> конфигурация stp

### 1.3 Установка приоритета

Выберем корневой коммутатор и присвоим наименьший приоритет.

`create stp instance_id 1`

`config stp priority 4096 instance_id 1`

<img src="Снимок экрана от 2021-11-24 09-12-46.png" />

`show stp ports`

<img src="Снимок экрана от 2021-11-24 09-14-35.png" />
> ~~1 port index~~

<img src="Снимок экрана от 2021-11-24 09-16-16.png" />

> 22 port index

<img src="Снимок экрана от 2021-11-24 09-16-54.png" />
> 26 port index

### 1.4 Подключим второй патч-корд

### 1.5 Настроим граничные порты

`config stp ports 1-5 edge true`

### 1.6 Посмотрим на каждом коммутаторе стоимость пути и настройку STP

### 1.7 Запустим проверку связи между компьютерами и отключим основную линию связи

Зафиксируем потерю пакетов.

<img src="Снимок экрана от 2021-11-24 09-27-35.png" />
> пинг

### 1.8. Посмотрим роли и состояния 24, 25 портов во время перестройки топологии

После отключения 26 порта (который бул root), альтернативный 22 поменял статус на root

<img src="Снимок экрана от 2021-11-24 09-20-11.png" />
> смена порта

## 2 Часть

Настройка протокола связующего дерева RSTP

### 2.1 Включим протокол связующего дерева на коммутаторе

`config stp version rstp`

### 2.2. Проверим текущую конфигурацию протокола связующего дерева

Протокол RSTP используется по умолчанию. Если нет, активизируем его.

<img src="Снимок экрана от 2021-11-24 09-31-35.png" />
> конфигурация stp

### 2.3. Установка приоритета

Установите на коммутаторе наименьшее значение приоритета, чтобы он мог быть выбран корневым мостом (приоритет по умолчанию = 32768).

`установили`

### 2.4. Просмотрите выполненные изменения

<img src="Снимок экрана от 2021-11-24 09-33-25.png" />
> до отключения 26 порта

<img src="Снимок экрана от 2021-11-24 09-34-08.png" />
> после

### 2.5. Назначим граничные порты

`уже установлены`

### 2.6. Активизируем протокол связующего дерева на всех портах

Настройка коммутатора 2

### 2.7. Активизируем функцию связующего дерева

### 2.8. Проверим текущую конфигурацию протокола связующего дерева

Протокол RSTP используется по умолчанию. Если нет, включим его.

### 2.9. Назначим граничные порты

### 2.10. Активизируем протокол связующего дерева на портах

Разрыва в пинге не было

<img src="Снимок экрана от 2021-11-24 09-35-48.png" />
> пинг

3. Сравнение STP и RSTP

```
   3.1. Какой коммутатор является корневым?
   3.2. Какие порты являются заблокированными?
   3.3. Какая роль у заблокированных портов?
   3.4. Выполните продолжительный тест ping от компьютера ПК1 до ПК2 и наоборот.
   Отсоедините кабель от корневого порта.
   3.5. Что происходит с тестом ping?
   3.6. Превышен ли интервал ожидания для запроса.
   3.7. Как долго пришлось ждать до появления ответа?
   3.8. Проверьте состояние заблокированного порта, какая теперь у него роль?
   Подключите обратно кабель.
   3.9. Поменяйте версию протокола связующего дерева с RSTP на STP на обоих коммутаторах.
   3.10. Выполните продолжительный ping от компьютера ПК1 до ПК2 и наоборот.
   Отсоедините кабель от корневого порта.
   3.11. Что происходит с тестом ping?
   3.12. Превышен ли интервал ожидания для запроса?
   3.13. Как долго пришлось ждать до появления ответа?
```

